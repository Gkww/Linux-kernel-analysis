# Linux硬件基础
了解`Linux`内核，首先要认识到操作系统和一般软件的不同，操作系统是一种充分挖掘硬件潜能的软件，因此要想深入解析操作系统内在的运作机制，就必须搞清楚相关的硬件机制。
Linux 把与硬件相关的代码全部放在 arch目录下，在这个目录下，有 arm、alpha,i386、m68k、mips 等十多种，在这众多的平台中，大家熟悉的就是 i386，即 Inte l80386。
因此，我们所介绍的硬件基础也是以此为背景的。
# i386寄存器
## 通用寄存器
8 个通用寄存器是 8086 寄存器的超集，它们的名称和用途分别为：
* EAX：一般用作累加器。 
* EBX：一般用作基址寄存器（Base）。 
* ECX：一般用来计数（Count）。 
* EDX：一般用来存放数据（Data）。 
* EBP：一般用作堆栈指针（Stack Pointer）。 
* EBP：一般用作基址指针（Base Pointer）。 
* ESI：一般用作源变址（Source Index）。 
* EDI：一般用作目标变址（Destinatin Index）。 
> 这 8 个通用寄存器既可以支持 1 位、8 位、16 位和 32 位数据运算，也支持 16 位和 32 位存储
器寻址。 
## 段寄存器
8086 中有 4 个 16 位的段寄存器：CS、DS、SS、ES，分别用于存放可执行代码的代码段、数据段、堆栈段和其他段的基地址
> CS：代码段寄存器。 
> DS：数据段寄存器。 
> SS：堆栈段寄存器。 
> ES、FS 及 GS：附加数据段寄存器。
## 状态和控制寄存器
### 指令指针寄存器和标志寄存器
* 指令指针寄存器（EIP）中存放下一条将要执行指令的偏移量，这个偏移量是相对于目前正在运行的代码段寄存（CS）而言的。偏移量加上当前代码段的基地址，就形成了下一条指令的地址
* 标志寄存器定义图

![i386标志寄存器](images/1.png)
...([其他的寄存器链接如下](https://blog.csdn.net/weixin_45611297/article/details/124284991))
## 内存地址
在计算机内，都存在一个程序能产生的内存地址的集合，当程序执行如下指令:
`MOVE REG,ADDR`,它把地址为 ADDR（假设为 10000）的内存单元的内容复制到 REG 中，地址 ADDR 可以通过索引、基址寄存器、段寄存器和其他方式产生。
在 8086 的实模式下，把某一段寄存器左移 4 位，然后与地址 ADDR 相加后被直接送到内
存总线上，这个相加后的地址就是内存单元的物理地址，而程序中的这个地址就叫逻辑地址，在 80386 的保护模式下，这个逻辑地址不是被直接送到内存总线，而是被送到内存管理单元（MMU）,`MMU` 由一个或一组芯片组成，其功能是把逻辑地址映射为物理地址，即进行地址转换，如图所示。
![MMU的位置和功能](images/2.png)
80386的三种不同的地址:
* 逻辑地址
* 线性地址
* 物理地址
> MMU把逻辑地址转换为物理地址的过程
![MMU转化过程](images/3.png)
## 描述符概念
所谓描述符（Descriptor），就是描述段的属性的一个 8 字节存储单元。在实模式下，段的属性不外乎是代码段、堆栈段、数据段、段的起始地址、段的长度等，而在保护模式下则复杂一些。80386 将它们结合在一起用一个 8 字节的数表示，称为描述符
* 用户段描述符如下:
![用户段描述符](images/4.png)



